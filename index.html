<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Attendance</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#fff;
}

.app{
  padding:16px;
  max-width:720px;
  margin:auto;
}

h2{text-align:center}

input,button{
  font-size:16px;
  padding:14px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,.1);
  background:rgba(255,255,255,.65);
}

button:active{
  transform:scale(.96);
  box-shadow:inset 0 2px 6px rgba(0,0,0,.15);
}

.top{
  display:flex;
  gap:8px;
}

input{flex:1}

.card{
  margin-top:14px;
  padding:14px;
  border-radius:16px;
  border:1px solid rgba(0,0,0,.08);
  background:rgba(255,255,255,.65);
}

.subject{font-weight:600}

.count{
  font-size:13px;
  color:#666;
  margin:6px 0;
}

.actions{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.present{color:#34c759}
.absent{color:#ff3b30}
.holiday{color:#ff9500}
.undo{font-size:18px}

.disabled{
  opacity:.5;
}
</style>
</head>

<body>
<div class="app">
<h2>Attendance</h2>

<div class="top">
  <input id="subjectInput" placeholder="Add subject">
  <button id="addBtn">ï¼‹</button>
</div>

<div class="top" style="margin-top:10px">
  <button id="holidayBtn" class="holiday">ðŸŽ‰ Holiday</button>
  <button id="undoHolidayBtn">â†¶ Undo Holiday</button>
</div>

<div id="list"></div>
</div>

<script>
(function(){
  const input = document.getElementById("subjectInput");
  const addBtn = document.getElementById("addBtn");
  const list = document.getElementById("list");
  const holidayBtn = document.getElementById("holidayBtn");
  const undoHolidayBtn = document.getElementById("undoHolidayBtn");

  const today = new Date().toISOString().split("T")[0];

  let data = JSON.parse(localStorage.getItem("attendance")) || [];
  let holidays = JSON.parse(localStorage.getItem("holidays")) || {};

  function save(){
    localStorage.setItem("attendance", JSON.stringify(data));
    localStorage.setItem("holidays", JSON.stringify(holidays));
  }

  function count(rec, val){
    let n = 0;
    for(const d in rec){
      if(rec[d] === val) n++;
    }
    return n;
  }

  function render(){
    list.innerHTML = "";

    const isHolidayToday = !!holidays[today];

    holidayBtn.disabled = isHolidayToday;
    undoHolidayBtn.disabled = !isHolidayToday;

    data.forEach(function(s, i){
      if(!s.records) s.records = {};

      const p = count(s.records,"P");
      const a = count(s.records,"A");
      const todayMarked = s.records[today];
      const disableAttendance = isHolidayToday || todayMarked;

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <div class="subject">${s.name}</div>
        <div class="count">âœ” ${p} days &nbsp; âœ– ${a} days</div>
        <div class="actions ${disableAttendance?'disabled':''}">
          <button class="present" ${disableAttendance?'disabled':''}>Present</button>
          <button class="absent" ${disableAttendance?'disabled':''}>Absent</button>
          <button class="undo">â†¶</button>
        </div>
      `;

      card.querySelector(".present").onclick = function(){
        s.records[today] = "P";
        save(); render();
      };

      card.querySelector(".absent").onclick = function(){
        s.records[today] = "A";
        save(); render();
      };

      card.querySelector(".undo").onclick = function(){
        delete s.records[today];
        save(); render();
      };

      list.appendChild(card);
    });
  }

  addBtn.onclick = function(){
    const name = input.value.trim();
    if(!name) return;
    data.push({name:name, records:{}});
    input.value="";
    save(); render();
  };

  holidayBtn.onclick = function(){
    holidays[today] = true;
    save(); render();
  };

  undoHolidayBtn.onclick = function(){
    delete holidays[today];
    save(); render();
  };

  render();
})();
</script>
</body>
</html>

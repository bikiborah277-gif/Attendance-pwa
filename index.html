<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  color:#fff;
  min-height:100vh;
  background:
    url("https://img.freepik.com/premium-photo/mesh-holographic-gradient-background_57613-84.jpg")
    center/cover no-repeat;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  backdrop-filter:blur(8px);
  background:rgba(0,0,0,.45);
  pointer-events:none;
}

.app{
  max-width:420px;
  margin:auto;
  padding:16px;
  position:relative;
}

.card{
  background:rgba(255,255,255,0.12);
  border-radius:22px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.btn{
  border:none;
  border-radius:18px;
  padding:10px 16px;
  font-size:14px;
  background:rgba(255,255,255,0.2);
  color:white;
}

.btn.holiday.active{
  background:#f59e0b;
  color:#000;
}

.add-row{
  display:flex;
  gap:10px;
  align-items:center;
}

.add-row input{
  flex:1;
  padding:12px 14px;
  border-radius:18px;
  border:none;
  background:rgba(255,255,255,0.15);
  color:white;
  outline:none;
}

.add-row button{
  width:44px;
  height:44px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,0.25);
  color:white;
  font-size:22px;
}

.subject{
  position:relative;
  transition:.3s;
}

.subject.good{
  box-shadow:0 0 20px rgba(34,197,94,.7);
}

.subject.bad{
  box-shadow:0 0 20px rgba(239,68,68,.7);
}

.sub-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}

.stats{
  font-size:13px;
  opacity:.85;
}

.actions{
  display:flex;
  gap:8px;
  margin-top:10px;
}

.actions button{
  flex:1;
  border:none;
  border-radius:16px;
  padding:10px 0;
  font-size:15px;
  color:#fff;
}

.p{background:#22c55e}
.a{background:#ef4444}
.u{background:#64748b}

.disabled{
  opacity:.4;
  pointer-events:none;
}
</style>
</head>

<body>
<div class="app">

  <div class="card top">
    <strong id="date"></strong>
    <button id="holidayBtn" class="btn holiday">Holiday</button>
  </div>

  <div class="card add-row">
    <input id="subjectInput" placeholder="Add subject…">
    <button id="addBtn">＋</button>
  </div>

  <div id="subjects"></div>

</div>

<script>
const today = new Date().toISOString().slice(0,10);
const store = JSON.parse(localStorage.getItem("att")||"{}");

store[today] ||= { holiday:false, subjects:{} };

const save = ()=>localStorage.setItem("att",JSON.stringify(store));

document.getElementById("date").textContent =
  new Date().toDateString();

const holidayBtn = document.getElementById("holidayBtn");
holidayBtn.classList.toggle("active",store[today].holiday);

holidayBtn.onclick = ()=>{
  store[today].holiday = !store[today].holiday;
  save(); render();
};

document.getElementById("addBtn").onclick = ()=>{
  const v = subjectInput.value.trim();
  if(!v || store[today].subjects[v]) return;
  store[today].subjects[v] = {p:0,a:0,last:null};
  subjectInput.value="";
  save(); render();
};

function render(){
  const wrap = document.getElementById("subjects");
  wrap.innerHTML="";

  for(const [name,s] of Object.entries(store[today].subjects)){
    const total = s.p + s.a;
    const percent = total ? Math.round((s.p/total)*100) : 0;

    const card = document.createElement("div");
    card.className="card subject";

    if(percent < 75 && percent>0) card.classList.add("bad");
    else if(percent >= 85) card.classList.add("good");

    card.innerHTML=`
      <div class="sub-head">
        <strong>${name}</strong>
        <span class="stats">${percent}%</span>
      </div>
      <div class="stats">P ${s.p} • A ${s.a}</div>
      <div class="actions">
        <button class="p">P</button>
        <button class="a">A</button>
        <button class="u">↺</button>
      </div>
    `;

    const [p,a,u] = card.querySelectorAll("button");

    if(store[today].holiday){
      p.classList.add("disabled");
      a.classList.add("disabled");
      u.classList.add("disabled");
    }

    p.onclick=()=>{s.p++; s.last="P"; save(); render();};
    a.onclick=()=>{s.a++; s.last="A"; save(); render();};
    u.onclick=()=>{
      if(s.last==="P") s.p--;
      if(s.last==="A") s.a--;
      s.last=null;
      save(); render();
    };

    wrap.appendChild(card);
  }
}

render();
</script>
</body>
</html>

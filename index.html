<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>Offline Attendance</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:linear-gradient(160deg,#0f172a,#020617);
  color:#fff;
  min-height:100vh;
}
.app{
  max-width:420px;
  margin:auto;
  padding:16px;
}
.card{
  background:rgba(255,255,255,0.08);
  border-radius:22px;
  padding:16px;
  margin-bottom:16px;
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}
.btn{
  border:none;
  border-radius:18px;
  padding:12px 16px;
  font-size:15px;
  background:rgba(255,255,255,0.15);
  color:white;
}
.btn:active{transform:scale(.96)}
.btn.holiday.active{background:#f59e0b;color:#000}
.stats{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
  font-size:14px;
}
.subject{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:10px;
}
.actions button{
  margin-left:6px;
  padding:8px 12px;
  border-radius:14px;
  border:none;
}
.p{background:#22c55e}
.a{background:#ef4444}
.u{background:#64748b}
.disabled{opacity:.4;pointer-events:none}
.calendar h3{margin:0 0 10px}
.grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  text-align:center;
}
.day-name{opacity:.6;font-size:12px}
.day{
  padding:10px 0;
  border-radius:12px;
}
.today{outline:2px solid #38bdf8}
.holiday-day{background:#f59e0b;color:#000}
</style>
</head>

<body>
<div class="app">

<div class="card">
  <div class="top">
    <strong id="dateLabel"></strong>
    <button class="btn holiday" id="holidayBtn">Holiday</button>
  </div>
  <div class="stats">
    <span>Present: <b id="pCount">0</b></span>
    <span>Absent: <b id="aCount">0</b></span>
  </div>
</div>

<div class="card" id="subjects"></div>

<div class="card calendar">
  <h3 id="monthLabel"></h3>
  <div class="grid" id="calendar"></div>
</div>

</div>

<script>
const today=new Date();
const key=today.toISOString().slice(0,10);
const store=JSON.parse(localStorage.getItem("attendance")||"{}");
store[key]=store[key]||{holiday:false,subjects:{Math:null,Physics:null}};
localStorage.setItem("attendance",JSON.stringify(store));

const dateLabel=document.getElementById("dateLabel");
dateLabel.textContent=today.toDateString();

const holidayBtn=document.getElementById("holidayBtn");
holidayBtn.classList.toggle("active",store[key].holiday);
holidayBtn.onclick=()=>{
  store[key].holiday=!store[key].holiday;
  save();render();
};

function save(){localStorage.setItem("attendance",JSON.stringify(store));}

function render(){
  const box=document.getElementById("subjects");
  box.innerHTML="";
  let p=0,a=0;
  for(let s in store[key].subjects){
    const v=store[key].subjects[s];
    if(v==="P")p++;
    if(v==="A")a++;
    const row=document.createElement("div");
    row.className="subject";
    row.innerHTML=`<span>${s}</span>`;
    const act=document.createElement("div");
    act.className="actions";
    ["P","A"].forEach(t=>{
      const b=document.createElement("button");
      b.textContent=t;
      b.className=t==="P"?"p":"a";
      if(v||store[key].holiday)b.classList.add("disabled");
      b.onclick=()=>{store[key].subjects[s]=t;save();render();}
      act.appendChild(b);
    });
    if(v){
      const u=document.createElement("button");
      u.textContent="â†º";
      u.className="u";
      if(store[key].holiday)u.classList.add("disabled");
      u.onclick=()=>{store[key].subjects[s]=null;save();render();}
      act.appendChild(u);
    }
    row.appendChild(act);
    box.appendChild(row);
  }
  document.getElementById("pCount").textContent=p;
  document.getElementById("aCount").textContent=a;
}
render();

// Calendar
const cal=document.getElementById("calendar");
const mLabel=document.getElementById("monthLabel");
const y=today.getFullYear(),m=today.getMonth();
mLabel.textContent=today.toLocaleString("default",{month:"long",year:"numeric"});
["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(d=>{
  const e=document.createElement("div");
  e.textContent=d;
  e.className="day-name";
  cal.appendChild(e);
});
const first=new Date(y,m,1).getDay();
const days=new Date(y,m+1,0).getDate();
for(let i=0;i<first;i++)cal.appendChild(document.createElement("div"));
for(let d=1;d<=days;d++){
  const cell=document.createElement("div");
  cell.textContent=d;
  cell.className="day";
  const dt=new Date(y,m,d);
  if(dt.toDateString()===today.toDateString())cell.classList.add("today");
  if(dt.getDay()===0)cell.classList.add("holiday-day");
  cal.appendChild(cell);
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance</title>

<style>
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  min-height:100vh;

  background:
    url("https://img.freepik.com/premium-photo/mesh-holographic-gradient-background_57613-84.jpg?semt=ais_hybrid&w=740&q=80")
    no-repeat center/cover;

  background-blend-mode:overlay;
  background-color: #0f172a;
  color:#fff;
}
.app{
  max-width:420px;
  margin:auto;
  padding:16px;
}

/* ---------- GLASS CORE ---------- */
.glass{
  position:relative;
  border:1px solid rgba(255,255,255,.25);
  background:linear-gradient(
    180deg,
    rgba(255,255,255,.35),
    rgba(255,255,255,.08)
  );
  backdrop-filter:blur(18px) saturate(180%);
  -webkit-backdrop-filter:blur(18px) saturate(180%);
  box-shadow:
    inset 0 1px 1px rgba(255,255,255,.6),
    inset 0 -1px 1px rgba(0,0,0,.2),
    0 10px 25px rgba(0,0,0,.25);
}
.glass::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  background:linear-gradient(
    120deg,
    rgba(255,255,255,.6),
    rgba(255,255,255,0)
  );
  opacity:.35;
  pointer-events:none;
}

/* ---------- HEADER ---------- */
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}
.holiday-btn{
  padding:10px 18px;
  border-radius:999px;
  color:white;
}
.holiday-btn.active{
  background:#f59e0b;
  color:#000;
}

/* ---------- ADD SUBJECT ---------- */
.add-subject{
  display:flex;
  gap:8px;
  margin-bottom:16px;
}
.add-subject input{
  flex:1;
  padding:12px 16px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.25);
  background:rgba(255,255,255,.08);
  color:white;
  outline:none;
  backdrop-filter:blur(14px);
}
.add-subject button{
  width:42px;height:42px;
  border-radius:50%;
  color:white;
}

/* ---------- SUBJECT CARD ---------- */
.card{
  padding:14px 16px;
  border-radius:24px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  transition:box-shadow .3s ease;
}
.card.good{
  box-shadow:0 0 18px rgba(34,197,94,.45);
}
.card.bad{
  box-shadow:0 0 18px rgba(239,68,68,.45);
}

.subject-name{font-weight:500;}

.stats{
  display:flex;
  gap:8px;
  font-size:12px;
  opacity:.9;
}
.stats span{
  padding:4px 8px;
  border-radius:12px;
  background:rgba(255,255,255,.12);
}

/* ---------- ACTION BUTTONS ---------- */
.actions{
  display:flex;
}
.circle{
  width:36px;
  height:36px;
  border-radius:50%;
  display:grid;
  place-items:center;
  margin-left:6px;
  border:1px solid rgba(255,255,255,.25);
  backdrop-filter:blur(14px);
  box-shadow:
    inset 0 1px 1px rgba(255,255,255,.6),
    inset 0 -1px 1px rgba(0,0,0,.25),
    0 8px 18px rgba(0,0,0,.25);
  font-weight:bold;
  color:white;
}
.p{background:rgba(34,197,94,.8);}
.a{background:rgba(239,68,68,.8);}
.u{background:rgba(100,116,139,.8);}
.disabled{opacity:.3;pointer-events:none;}
</style>
</head>

<body>
<div class="app">

  <div class="top">
    <strong id="dateLabel"></strong>
    <button class="glass holiday-btn" id="holidayBtn">Holiday</button>
  </div>

  <div class="add-subject">
    <input id="subjectInput" placeholder="Add subject">
    <button class="glass" id="addBtn">+</button>
  </div>

  <div id="subjects"></div>
</div>

<script>
const today = new Date();
const dayKey = today.toISOString().slice(0,10);

let store = JSON.parse(localStorage.getItem("attendance")||"{}");
store[dayKey] ??= { holiday:false, subjects:{} };

dateLabel.textContent = today.toDateString();

const subjectsDiv = document.getElementById("subjects");
const subjectInput = document.getElementById("subjectInput");
const addBtn = document.getElementById("addBtn");
const holidayBtn = document.getElementById("holidayBtn");

function save(){
  localStorage.setItem("attendance",JSON.stringify(store));
}

function render(){
  holidayBtn.classList.toggle("active",store[dayKey].holiday);
  subjectsDiv.innerHTML="";

  for(const name in store[dayKey].subjects){
    const s = store[dayKey].subjects[name];
    const total = s.p + s.a;
    const percent = total ? Math.round((s.p / total) * 100) : 0;

    const card = document.createElement("div");
    card.className = "glass card";
   if (percent < 75 && percent > 0) {
  card.classList.add("bad");
} 
else if (percent >= 85) {
  card.classList.add("good");
}

    const left = document.createElement("div");
    left.innerHTML = `
      <div class="subject-name">${name}</div>
      <div class="stats">
        <span>P ${s.p}</span>
        <span>A ${s.a}</span>
        <span>${percent}%</span>
      </div>
    `;

    const actions = document.createElement("div");
    actions.className="actions";

    const p=document.createElement("div");
    p.textContent="P"; p.className="circle p";
    p.classList.toggle("disabled",s.today||store[dayKey].holiday);
    p.onclick=()=>{s.p++;s.last="P";s.today=true;save();render();};

    const a=document.createElement("div");
    a.textContent="A"; a.className="circle a";
    a.classList.toggle("disabled",s.today||store[dayKey].holiday);
    a.onclick=()=>{s.a++;s.last="A";s.today=true;save();render();};

    const u=document.createElement("div");
    u.textContent="â†º"; u.className="circle u";
    u.classList.toggle("disabled",!s.today||store[dayKey].holiday);
    u.onclick=()=>{
      if(s.last==="P")s.p--;
      if(s.last==="A")s.a--;
      s.today=false;
      s.last=null;
      save();render();
    };

    actions.append(p,a,u);
    card.append(left,actions);
    subjectsDiv.appendChild(card);
  }
}

function addSubject(){
  const name = subjectInput.value.trim();
  if(!name || store[dayKey].subjects[name]) return;
  store[dayKey].subjects[name]={p:0,a:0,today:false,last:null};
  subjectInput.value="";
  save(); render();
}

addBtn.onclick = addSubject;
subjectInput.onkeydown = e => e.key==="Enter" && addSubject();

holidayBtn.onclick = ()=>{
  store[dayKey].holiday = !store[dayKey].holiday;
  save(); render();
};

render();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Attendance</title>

<style>
:root{
  --p:#22c55e; --a:#ef4444; --h:#f59e0b;
  --glass:rgba(255,255,255,.4);
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{margin:0;background:#f3f3f3;padding:12px}
.app{max-width:420px;margin:auto;background:#fff;border-radius:20px;padding:14px}

h2{text-align:center;margin:6px 0}

input{
  width:100%;padding:12px;border-radius:14px;border:0;
  background:#eee;margin-bottom:8px
}

.subjects{display:flex;gap:6px;overflow-x:auto;margin-bottom:10px}
.sub{
  padding:8px 14px;border-radius:999px;background:#eee;
  font-size:13px;white-space:nowrap
}
.sub.active{background:#000;color:#fff}

.stats{display:flex;justify-content:space-between;font-size:13px;margin:8px 0}

.actions{display:flex;gap:8px;margin-bottom:10px}
button{
  flex:1;padding:12px;border-radius:14px;border:0;
  background:var(--glass);backdrop-filter:blur(10px);
  font-weight:600;box-shadow:0 6px 16px rgba(0,0,0,.15);
  transition:.15s
}
button:active{transform:scale(.94)}

.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;text-align:center}
.day{font-size:11px;font-weight:600}
.cell{
  padding:8px 0;border-radius:12px;background:#eee;font-size:12px
}
.P{background:var(--p);color:#fff}
.A{background:var(--a);color:#fff}
.H{background:var(--h);color:#fff}
.today{outline:2px solid #000}
</style>
</head>

<body>
<div class="app">

<h2 id="title"></h2>

<input id="subInput" placeholder="Add subject" onkeydown="if(event.key==='Enter')addSub()">

<div class="subjects" id="subs"></div>

<div class="stats">
  <div>Present: <b id="pc">0</b></div>
  <div>Absent: <b id="ac">0</b></div>
</div>

<div class="actions">
  <button onclick="mark('P')">Present</button>
  <button onclick="mark('A')">Absent</button>
  <button onclick="mark('H')">Holiday</button>
  <button onclick="undo()">Undo</button>
</div>

<div class="calendar" id="cal"></div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("att")||"{}");
let currentSub = Object.keys(data)[0] || null;

const today = new Date();
const todayKey = today.toISOString().slice(0,10);

function save(){localStorage.setItem("att",JSON.stringify(data));render()}

function addSub(){
  const v=subInput.value.trim();
  if(!v || data[v])return;
  data[v]={}; currentSub=v; subInput.value="";
  save();
}

function switchSub(s){currentSub=s;render()}

function mark(t){
  if(!currentSub)return;
  data[currentSub][todayKey]=t;
  save();
}
function undo(){
  if(!currentSub)return;
  delete data[currentSub][todayKey];
  save();
}

function render(){
  const subs=document.getElementById("subs");
  subs.innerHTML="";
  Object.keys(data).forEach(s=>{
    const d=document.createElement("div");
    d.className="sub"+(s===currentSub?" active":"");
    d.textContent=s;
    d.onclick=()=>switchSub(s);
    subs.appendChild(d);
  });

  const y=today.getFullYear(), m=today.getMonth();
  title.textContent=today.toLocaleString("default",{month:"long",year:"numeric"});

  cal.innerHTML="";
  ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(d=>{
    const e=document.createElement("div");
    e.className="day"; e.textContent=d; cal.appendChild(e);
  });

  let first=new Date(y,m,1).getDay();
  for(let i=0;i<first;i++)cal.appendChild(document.createElement("div"));

  let P=0,A=0;
  const days=new Date(y,m+1,0).getDate();
  for(let d=1;d<=days;d++){
    const date=new Date(y,m,d);
    const key=date.toISOString().slice(0,10);
    const cell=document.createElement("div");
    cell.className="cell";
    const sun=date.getDay()===0;
    const st = sun ? "H" : data[currentSub]?.[key];
    if(st)cell.classList.add(st);
    if(key===todayKey)cell.classList.add("today");
    if(st==="P")P++; if(st==="A")A++;
    cell.textContent=d;
    cal.appendChild(cell);
  }
  pc.textContent=P; ac.textContent=A;
}

render();
</script>
</body>
</html>
